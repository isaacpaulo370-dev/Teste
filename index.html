<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cadeados por Continente ‚Äî Avi√£o</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin=""/>
  <style>
    body{ margin:0; font-family:system-ui, sans-serif; background:linear-gradient(160deg,#e9f0ff,#d6e7ff); }
    .center-screen{ display:flex; align-items:center; justify-content:center; min-height:100vh; padding:20px; }
    .card{ background:#fff; padding:20px; border-radius:12px; box-shadow:0 8px 24px rgba(0,0,0,0.08); text-align:center; max-width:960px; width:100%; }
    .plane-wrap{ position:relative; width:100%; max-width:760px; margin:0 auto 12px; }
    .plane-svg{ width:100%; height:auto; display:block; }
    .windows{ position:absolute; left:0; top:0; width:100%; height:100%; }
    .win{ position:absolute; width:40px; height:40px; transform:translate(-50%,-50%); display:flex; align-items:center; justify-content:center; background:#fff; border-radius:6px; box-shadow:0 2px 6px rgba(0,0,0,0.2); }
    .win input{ width:100%; height:100%; border:none; outline:none; text-align:center; font-size:18px; font-weight:700; text-transform:uppercase; }
    button{ padding:10px 14px; border-radius:8px; border:none; background:#2563eb; color:#fff; font-weight:600; cursor:pointer; margin-top:8px; }
    #map{ height:75vh; width:100%; display:none; border-radius:10px; margin-top:8px; }
    .topbar{ position:fixed; left:12px; top:12px; z-index:1000; background:#fff; padding:8px 12px; border-radius:8px; box-shadow:0 4px 12px rgba(0,0,0,0.08); display:none; }
    .hint{ font-size:13px; color:#555; margin-top:6px; }
  </style>
</head>
<body>

  <div class="topbar" id="topbar">Cadeados desbloqueados: <span id="count">0</span>/6</div>

  <div class="center-screen" id="intro">
    <div class="card">
      <h1>Desbloqueie o avi√£o para seguir viagem</h1>
      <p>Cada janela do avi√£o √© uma letra da senha.</p>

      <div class="plane-wrap">
        <!-- Avi√£o SVG -->
        <svg class="plane-svg" viewBox="0 0 1200 360" xmlns="http://www.w3.org/2000/svg">
          <rect x="60" y="110" rx="60" ry="60" width="980" height="140" fill="#90cdf4" />
          <ellipse cx="1020" cy="180" rx="60" ry="70" fill="#7fb6e9"/>
          <path d="M60 110 L20 80 L60 180 Z" fill="#7fb6e9"/>
          <path d="M320 240 L640 140 L760 160 L420 260 Z" fill="#60a5fa"/>
          <path d="M700 40 L820 100 L680 120 L620 60 Z" fill="#60a5fa"/>
          <!-- Janelas -->
          <circle cx="250" cy="160" r="22" fill="#e6f6ff"/>
          <circle cx="320" cy="160" r="22" fill="#e6f6ff"/>
          <circle cx="390" cy="160" r="22" fill="#e6f6ff"/>
          <circle cx="460" cy="160" r="22" fill="#e6f6ff"/>
          <circle cx="530" cy="160" r="22" fill="#e6f6ff"/>
          <circle cx="600" cy="160" r="22" fill="#e6f6ff"/>
          <circle cx="670" cy="160" r="22" fill="#e6f6ff"/>
          <circle cx="740" cy="160" r="22" fill="#e6f6ff"/>
          <circle cx="810" cy="160" r="22" fill="#e6f6ff"/>
          <circle cx="880" cy="160" r="22" fill="#e6f6ff"/>
          <circle cx="950" cy="160" r="22" fill="#e6f6ff"/>
        </svg>
        <!-- Inputs -->
        <div class="windows" id="windowsContainer"></div>
      </div>

      <div class="hint">Dica: o que cada envelope tem em comum?</div>

      <button id="introBtn">Decolar</button>
      <div id="introMsg" style="margin-top:10px;font-weight:700;color:crimson;"></div>
    </div>
  </div>

  <div id="mapArea" style="display:none; padding:12px;">
    <div id="map"></div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    const introPassword = 'continentes';
    const vbW = 1200, vbH = 360;

    const windowCoords = [
      {cx:250,cy:160}, {cx:320,cy:160}, {cx:390,cy:160},
      {cx:460,cy:160}, {cx:530,cy:160}, {cx:600,cy:160},
      {cx:670,cy:160}, {cx:740,cy:160}, {cx:810,cy:160},
      {cx:880,cy:160}, {cx:950,cy:160}
    ];

    const windowsContainer = document.getElementById('windowsContainer');
    const inputs = [];
    introPassword.split('').forEach((_,i)=>{
      const div = document.createElement('div');
      div.className = 'win';
      div.style.left = (windowCoords[i].cx/vbW*100)+'%';
      div.style.top  = (windowCoords[i].cy/vbH*100)+'%';
      const inp = document.createElement('input');
      inp.maxLength=1;
      inp.dataset.index=i;
      inp.addEventListener('input',e=>{
        e.target.value = e.target.value.toUpperCase();
        if(e.target.value && i<introPassword.length-1) inputs[i+1].focus();
      });
      div.appendChild(inp);
      windowsContainer.appendChild(div);
      inputs.push(inp);
    });

    document.getElementById('introBtn').onclick = ()=>{
      const attempt = inputs.map(i=>i.value).join('').toLowerCase();
      if(attempt===introPassword){
        document.getElementById('intro').style.display='none';
        document.getElementById('mapArea').style.display='block';
        document.getElementById('map').style.display='block';
        document.getElementById('topbar').style.display='block';
        initMap();
      } else {
        document.getElementById('introMsg').textContent='Senha incorreta!';
      }
    };

    // ----- MAPA -----
    let map;
    const continentLocks = [
      { id:'america', title:'Am√©rica', coords:[40.7128, -74.0060], password:'arara azul', unlocked:false },
      { id:'europa', title:'Europa', coords:[51.5074, -0.1278], password:'olimp√≠adas', unlocked:false },
      { id:'oceania', title:'Oceania', coords:[-33.8688,151.2093], password:'Austr√°lia', unlocked:false },
      { id:'asia', title:'√Åsia', coords:[35.6762,139.6503], password:'China', unlocked:false },
      { id:'africa', title:'√Åfrica', coords:[-1.2921,36.8219], password:'Rio Nilo', unlocked:false },
      { id:'antarctica', title:'Ant√°rtica', coords:[-82,135], password:'clima', unlocked:false }
    ];
    let unlockedCount=0;

    function initMap(){
      map=L.map('map').setView([20,0],2);
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

      continentLocks.forEach(lock=>{
        lock.marker=L.marker(lock.coords,{icon:L.divIcon({html:'üîí',iconSize:[32,32]})}).addTo(map);
        const html=`
          <div>
            <div style="font-weight:700">${lock.title}</div>
            <div id="msg-${lock.id}"></div>
            <input id="input-${lock.id}" placeholder="Senha" style="width:100%;margin-top:6px"/>
            <button id="btn-${lock.id}">OK</button>
          </div>`;
        lock.marker.bindPopup(html);
        lock.marker.on('popupopen',()=>{
          const inp=document.getElementById('input-'+lock.id);
          const btn=document.getElementById('btn-'+lock.id);
          const msg=document.getElementById('msg-'+lock.id);
          btn.onclick=()=>attemptLock(lock,inp.value,msg);
        });
      });
    }

    function attemptLock(lock,attemptRaw,msgEl){
      if(attemptRaw===lock.password){
        lock.unlocked=true;
        unlockedCount++;
        document.getElementById('count').textContent=unlockedCount;
        lock.marker.setIcon(L.divIcon({html:'üîì',iconSize:[32,32]}));
        msgEl.innerHTML='<span style="color:green">Correto!</span>';
        if(unlockedCount === continentLocks.length){
          setTimeout(()=>{
            L.popup({closeOnClick:false,autoClose:false})
              .setLatLng(map.getCenter())
              .setContent('<div style="font-weight:700;">Parab√©ns ‚Äî voc√™ desbloqueou todos os cadeados dos continentes! Boa viagem! ‚úàÔ∏è</div>')
              .openOn(map);
          },300);
        }
      } else {
        msgEl.innerHTML='<span style="color:red">Errado</span>';
      }
    }
  </script>
</body>
</html>
